{% extends 'home.html' %}
{% load static %}

{% block title %}Profile{% endblock %}
{% block profile %}
<button data-popover-target="popover-user-profile" type="button" class="hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 rounded-full px-1 py-1 dark:focus:ring-blue-800">
    <img class="w-10 h-10 rounded-full" src="{{ profile.profile_picture.url }}" alt="{{ profile.user.username }}">
</button>

<div data-popover id="popover-user-profile" role="tooltip" class="absolute z-10 invisible inline-block w-64 text-sm text-gray-500 transition-opacity duration-300 bg-white rounded-lg shadow-sm opacity-0 dark:text-gray-400 dark:bg-gray-800 dark:border-gray-600">
    <div class="rounded-lg bg-white px-4 pt-8 pb-10 shadow-lg">
        <div class="relative mx-auto w-36 rounded-full">
            <span class="absolute right-0 m-3 h-3 w-3 rounded-full bg-green-500 ring-2 ring-green-300 ring-offset-2"></span>
            {% if profile.profile_picture %}
                <img class="mx-auto h-auto w-full rounded-full" src="{{ profile.profile_picture.url }}" alt="Profile Picture">
            {% endif %}
        </div>
        <h1 class="my-1 text-center text-xl font-bold leading-8 text-gray-900">{{ profile.user.username }}</h1>
        <h3 class="font-lg text-semibold text-center leading-6 text-gray-600">Patient</h3>
        <ul class="mt-3 divide-y rounded bg-gray-100 py-2 px-3 text-gray-600 shadow-sm hover:text-gray-700 hover:shadow">
            <li class="flex items-center py-3 text-sm">
                <span>Status</span>
                <span class="ml-auto"><span class="rounded-full bg-green-200 py-1 px-2 text-xs font-medium text-green-700">Online</span></span>
            </li>
            <li class="flex items-center py-3 text-sm">
                <span>Email</span>
                <span class="ml-auto">{{ profile.user.email }}</span>
            </li>
            <li class="flex items-center py-3 text-sm">
                <span>Address</span>
                <span class="ml-auto">{{ profile.line1 }}</span>
            </li>
            <li class="flex items-center py-3 text-sm">
                <span>City</span>
                <span class="ml-auto">{{ profile.city }}</span>
            </li>
            <li class="flex items-center py-3 text-sm">
                <span>State</span>
                <span class="ml-auto">{{ profile.state }}</span>
            </li>
            <li class="flex items-center py-3 text-sm">
                <span>Pincode</span>
                <span class="ml-auto">{{ profile.pincode }}</span>
            </li>
            <li class="flex items-center py-3 text-sm">
                <span>Joined On</span>
                <span class="ml-auto">{{ profile.user.date_joined }}</span>
            </li>
        </ul>
    </div>
    <div data-popper-arrow></div>
</div>
{% endblock %}

{% block loginout %}
    <a href="{% url 'logout' %}" class="py-2 px-3 bg-gray-500 text-white rounded hover:bg-gray-400">Logout</a>
{% endblock %}

{% block content %}

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const datePicker = document.querySelector('[datepicker-autohide]');
        const dateInput = document.getElementById('appointment-date-1');

        // Function to format date in YYYY-MM-DD format
        function formatDate(date) {
            const d = new Date(date);
            const month = ('0' + (d.getMonth() + 1)).slice(-2);
            const day = ('0' + d.getDate()).slice(-2);
            const year = d.getFullYear();
            return `${year}-${month}-${day}`;
        }

        datePicker.addEventListener('change', function () {
            const selectedDate = formatDate(datePicker.value);
            dateInput.value = selectedDate;
        });
    });
</script>
{% endblock %}
